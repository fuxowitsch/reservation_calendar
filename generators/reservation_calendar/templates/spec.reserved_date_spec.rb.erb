require 'spec_helper'

describe <%=subclass_name.pluralize.classify%> do

  it "should create a vaild model from blueprint" do
    <%=subclass_name%> = <%=subclass_name.classify%>.make()
    <%=subclass_name%>.should be_valid
  end

  describe "associations" do

    it "should belong to a reservation" do
      <%=subclass_name.classify%>.make_unsaved().should respond_to(:<%=class_name%>)
    end
  end

  describe "validations" do
   
  end

  describe "plugin methods" do

    describe "clip" do
      
      before(:each) do
        @<%=class_name%> = <%=class_name.classify%>.make(:reserved_dates => [
          <%=subclass_name.classify%>.make(:date => '11/12/2009'),
          <%=subclass_name.classify%>.make(:date => '11/13/2009'),
          <%=subclass_name.classify%>.make(:date => '11/14/2009'),
          <%=subclass_name.classify%>.make(:date => '11/11/2009'),
          <%=subclass_name.classify%>.make(:date => '11/10/2009'),
          <%=subclass_name.classify%>.make(:date => '11/15/2009'),
          <%=subclass_name.classify%>.make(:date => '11/16/2009')
        ])
      end
      
      it "should properly filter by the supplied date range when dates are in and out of the range" do
        @<%=class_name%>.reserved_dates.clip('11/12/2009', '11/14/2009').size.should == 3
      end

      it "should return an empty array when all dates are outside the supplied date range" do
        @<%=class_name%>.reserved_dates.clip('12/12/2009', '12/14/2009').size.should == 0
      end

      it "should return all dates when all dates are inside the supplied date range" do
        @<%=class_name%>.reserved_dates.clip('11/1/2009', '11/30/2009').size.should == 7
      end

    end
  end


end